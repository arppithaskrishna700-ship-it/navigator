body.map-page { overflow: hidden; display: flex; flex-direction: column; height: 100vh; }

.map-header {
  display: flex; align-items: center; gap: 1rem; padding: 0.85rem 1.5rem;
  background: var(--surface); border-bottom: 1px solid var(--border);
  flex-shrink: 0; flex-wrap: wrap; z-index: 10;
}
.back-link { color: var(--muted); text-decoration: none; font-size: 0.85rem; transition: color 0.2s; }
.back-link:hover { color: var(--accent); }
.map-brand { font-family: 'Playfair Display', serif; font-size: 1.2rem; font-weight: 900; color: var(--accent); }
.map-header-right { margin-left: auto; display: flex; gap: 0.75rem; align-items: center; }
.locate-btn, .add-btn {
  padding: 0.45rem 1rem; border-radius: 999px; font-family: 'Syne', sans-serif;
  font-size: 0.82rem; cursor: pointer; transition: all 0.2s; border: none;
}
.locate-btn { background: var(--card); color: var(--muted); border: 1px solid var(--border); }
.locate-btn:hover { border-color: var(--accent); color: var(--accent); }
.add-btn { background: var(--accent); color: #0e0b08; font-weight: 700; }
.add-btn:hover { opacity: 0.88; }

.map-body { display: grid; grid-template-columns: 340px 1fr; flex: 1; overflow: hidden; }

/* SIDEBAR */
.map-sidebar { background: var(--surface); border-right: 1px solid var(--border); display: flex; flex-direction: column; overflow: hidden; }
.sidebar-search { padding: 0.75rem; border-bottom: 1px solid var(--border); }
.sidebar-search input {
  width: 100%; background: var(--card); border: 1px solid var(--border); color: var(--text);
  padding: 0.5rem 0.9rem; border-radius: 8px; font-family: 'Syne', sans-serif;
  font-size: 0.85rem; outline: none; transition: border-color 0.2s;
}
.sidebar-search input:focus { border-color: var(--accent); }
.sidebar-search input::placeholder { color: var(--muted); }

.filter-row { display: flex; gap: 0.4rem; padding: 0.6rem 0.75rem; flex-wrap: wrap; border-bottom: 1px solid var(--border); }
.filter-btn { padding: 0.3rem 0.85rem; border-radius: 999px; border: 1px solid var(--border); background: var(--card); color: var(--muted); font-family: 'Syne', sans-serif; font-size: 0.76rem; cursor: pointer; transition: all 0.2s; white-space: nowrap; }
.filter-btn:hover, .filter-btn.active { background: var(--accent); color: #0e0b08; border-color: var(--accent); font-weight: 600; }

.price-filter { padding: 0.6rem 0.75rem; border-bottom: 1px solid var(--border); }
.price-filter label { font-size: 0.73rem; color: var(--muted); display: block; margin-bottom: 0.3rem; }
.price-filter input[type=range] { width: 100%; accent-color: var(--accent); }

.sidebar-count { padding: 0.5rem 0.75rem; font-size: 0.73rem; color: var(--muted); border-bottom: 1px solid var(--border); }
.sidebar-count span { color: var(--accent); font-weight: 700; }

.spots-list { overflow-y: auto; flex: 1; padding: 0.6rem; display: flex; flex-direction: column; gap: 0.5rem; }
.spots-list::-webkit-scrollbar { width: 3px; }
.spots-list::-webkit-scrollbar-thumb { background: var(--border); border-radius: 99px; }

.spot-card {
  background: var(--card); border: 1px solid var(--border); border-radius: 10px;
  padding: 0.85rem 1rem; cursor: pointer; transition: all 0.2s; position: relative; overflow: hidden;
}
.spot-card::before { content: ''; position: absolute; left: 0; top: 0; bottom: 0; width: 3px; background: var(--accent); opacity: 0; transition: opacity 0.2s; }
.spot-card:hover, .spot-card.selected { border-color: rgba(232,160,52,0.4); background: #2a2118; transform: translateX(2px); }
.spot-card:hover::before, .spot-card.selected::before { opacity: 1; }
.sc-top { display: flex; align-items: flex-start; justify-content: space-between; gap: 0.5rem; margin-bottom: 0.2rem; }
.sc-name { font-family: 'Playfair Display', serif; font-size: 0.95rem; font-weight: 700; color: var(--text); line-height: 1.2; }
.sc-area { font-size: 0.72rem; color: var(--muted); margin-bottom: 0.4rem; }
.sc-area span { color: var(--accent); }
.sc-desc { font-size: 0.77rem; color: #a09080; line-height: 1.5; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; margin-bottom: 0.5rem; }
.sc-meta { display: flex; gap: 0.8rem; font-size: 0.7rem; color: var(--muted); align-items: center; }
.sc-detail-link { font-size: 0.7rem; color: var(--accent); text-decoration: none; margin-left: auto; }
.sc-detail-link:hover { text-decoration: underline; }

.empty-state { text-align: center; padding: 2.5rem 1rem; color: var(--muted); }
.empty-state div { font-size: 2.5rem; margin-bottom: 0.75rem; }
.empty-state p { font-size: 0.82rem; line-height: 1.6; }

#map { width: 100%; height: 100%; }
.leaflet-popup-content-wrapper { background: var(--card) !important; color: var(--text) !important; border: 1px solid var(--border) !important; border-radius: 10px !important; box-shadow: 0 8px 32px rgba(0,0,0,0.5) !important; }
.leaflet-popup-tip { background: var(--card) !important; }
.leaflet-popup-close-button { color: var(--muted) !important; }
.popup-inner { min-width: 200px; }
.popup-name { font-family: 'Playfair Display', serif; font-size: 1rem; font-weight: 700; color: var(--accent); margin-bottom: 0.3rem; }
.popup-area { font-size: 0.73rem; color: var(--muted); margin-bottom: 0.35rem; }
.popup-meta { font-size: 0.73rem; color: var(--muted); display: flex; gap: 0.75rem; margin-bottom: 0.4rem; }
.popup-must { font-size: 0.73rem; color: var(--accent); margin-bottom: 0.5rem; }
.popup-link { display: inline-block; background: var(--accent); color: #0e0b08; padding: 0.35rem 0.9rem; border-radius: 999px; font-size: 0.75rem; font-weight: 700; text-decoration: none; margin-right: 0.4rem; }
.popup-nav { display: inline-block; color: var(--accent); padding: 0.35rem 0.9rem; border-radius: 999px; font-size: 0.75rem; font-weight: 700; text-decoration: none; border: 1px solid rgba(232,160,52,0.4); }
.popup-link:hover { opacity: 0.85; }
.leaflet-tile { filter: brightness(0.82) saturate(0.65); }

/* DRAWER */
.drawer {
  position: fixed; right: 0; top: 0; bottom: 0; width: 380px; max-width: 95vw;
  background: var(--surface); border-left: 1px solid var(--border);
  z-index: 8000; transform: translateX(100%); transition: transform 0.3s ease;
  overflow-y: auto;
}
.drawer.open { transform: translateX(0); }
.drawer-close { position: sticky; top: 0; float: right; margin: 1rem; background: var(--card); border: 1px solid var(--border); color: var(--muted); width: 32px; height: 32px; border-radius: 50%; cursor: pointer; font-size: 0.85rem; display: flex; align-items: center; justify-content: center; }
.drawer-content { padding: 1rem 1.25rem 2rem; clear: both; }
.drawer-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.5); z-index: 7999; display: none; }
.drawer-overlay.open { display: block; }

@media (max-width: 768px) {
  .map-body { grid-template-columns: 1fr; grid-template-rows: 280px 1fr; }
  .map-sidebar { border-right: none; border-bottom: 1px solid var(--border); height: 280px; }
}